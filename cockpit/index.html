<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Haas Firewall Control</title>

    <!-- Cockpit core JS API -->
    <script src="../base1/cockpit.js"></script>

    <!-- Cockpit base styles -->
    <link rel="stylesheet"
        href="../base1/cockpit.css">

    <!-- Extension stylesheet -->
    <link rel="stylesheet"
        href="haas-firewall.css">
</head>

<body>
    <h1>Haas Firewall Control</h1>
    <p>
        Use this page to simulate firewall changes, compare rules, edit the CSV, and rollback CSV backups.
    </p>

    <div class="section">
        <h2>Simulate / Compare</h2>
        <p>These operations do not make persistent changes to the firewall.</p>

        <div class="button-row">
            <button id="btn-dry-run"
                class="btn">Simulate Firewall Update (Dry-Run)</button>
            <button id="btn-compare"
                class="btn">Compare Current vs Planned Rules</button>
            <button id="btn-show-rules"
                class="btn">Show Current UFW Rules</button>
            <button id="btn-edit-csv"
                class="btn">Edit users.csv</button>
        </div>
    </div>

    <div class="section">
        <h2>Rollback CSV Backup</h2>
        <p>
            Restore a previous CSV backup from:
            <code>BACKUP_DIR</code> as defined in <code>/etc/haas-firewall.conf</code>.
        </p>

        <label for="backup-name">Backup filename (e.g. users_2025-01-13_12-00-00.csv)</label>
        <input type="text"
            id="backup-name"
            placeholder="Enter backup filename">

        <div class="button-row mt-1">
            <button id="btn-rollback"
                class="btn">Rollback CSV</button>
        </div>
    </div>

    <div class="section">
        <h2>Output</h2>

        <div class="output-controls">
            <button id="btn-clear"
                class="btn small">Clear Output</button>
            <div id="spinner"
                class="spinner hidden"></div>
        </div>

        <pre id="output"
            class="output-box">
Output will appear here...
        </pre>
    </div>

    <!-- Extension logic (load last so DOM exists) -->
    <script src="haas-firewall.js"></script>
</body>

</html>
